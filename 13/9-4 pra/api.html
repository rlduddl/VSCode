<!DOCTYPE html>

<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Movie DB</title>
    <link rel="stylesheet" href="api.css" />
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css" />
    <script src="circles-master/circles.min.js"></script>
  </head>
  <body>
    <header class="header">
      <div class="container">
        <div class="headerTop">
          <h1 class="logo"><a href="script-1.html">MOVIE DB</a></h1>
          <div>
            <button type="button" class="headerBtn">
              장르<i class="fa fa-caret-down"></i>
            </button>
            <button type="button" class="headerBtn">
              연도<i class="fa fa-caret-down"></i>
            </button>
          </div>
        </div>
        <div class="inputContainer">
          <i class="fa fa-search"></i>
          <input type="text" class="headerSearch" placeholder="영화 검색" />
        </div>
      </div>
    </header>
    <main class="container">
      <ol class="movieList" id="movieList">
        <!--<li>
          <a href="">
            <div class="imgContainer">
              <img src="https://picsum.photos/300/400" alt="" class="poster" />
            </div>
            <div class="infoContainer">
              <p class="date">2024-01-01</p>
              <h2 class="title">울버린</h2>
              <div class="rate">100</div>
            </div></a
          >
        </li>-->
      </ol>
    </main>

    <script>
      // 비동기 통신 : 서버에 네트워크 요청을 보내고 새로운 정보를 받아 올때 비동기 통신을 사용한다.
      // fetch : ajax (asynchronus javscript and xml)
      // https://api.themoviedb.org/3/movie/popular?api_key=daf14385d32e4bd56a9acaff4001de0c&language=ko-KR&page=1
      // fetch(url, [options]);
      fetch(
        "http://api.themoviedb.org/3/movie/popular?api_key=daf14385d32e4bd56a9acaff4001de0c&language=ko-KR&page=1"
      )
        .then((res) => res.json())
        .then((data) => {
          console.log(data);
          const { results } = data;
          let html = "";
          results.forEach((element, index) => {
            html += `
              <li>
                <a href="">
                  <div class="imgContainer">
                    <img src="https://image.tmdb.org/t/p/w500${element.poster_path}" alt="" class="title" />
                  </div>
                  <div class="infoContainer">
                    <p class="date">${element.release_date}</p>
                    <h2 class="title">${element.title}</h2>
                    <div class="rate" id="circle_${index}" data-rel="${element.vote_average}"></div>
                  </div></a
                >
              </li>
            `;
          });
          document.querySelector("#movieList").innerHTML = html;
          // pie 형태의 차트 출력
          document.querySelectorAll("#movieList li").forEach((item, index) => {
            const relItem = item.querySelector("#circle_" + index);
            var ccl = Circles.create({
              id: "circle_" + index,
              radius: 15,
              value: relItem.dataset.rel,
              maxValue: 10,
              width: 3,
              text: function (value) {
                return value;
              },
              colors: ["#EFEFEF", "#DB2D43"],
              duration: 400,
              wrpClass: "circles-wrp",
              textClass: "circles-text",
              valueStrokeClass: "circles-valueStroke",
              maxValueStrokeClass: "circles-maxValueStroke",
              styleWrapper: true,
              styleText: true,
            });
          });
        });
      // "https://image.tmdb.org/t/p" + poster_path
      // axios
    </script>
  </body>
</html>
